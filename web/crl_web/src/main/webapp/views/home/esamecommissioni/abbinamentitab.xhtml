<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">




<p:fieldset legend="Abbinamenti e disabbinamenti" toggleable="true"
	toggleSpeed="500">

	<!-- Messaggio azioni -->
	<p:growl id="abbinamentiMsg" showDetail="true" sticky="false" />



	<!-- Confirm dialog -->
	<p:confirmDialog id="confirmAbbinamentoDialog"
		message="Sei sicuro di voler eliminare l'abbinamento ?"
		header="Cancellazione Abbinamento" severity="alert"
		widgetVar="abbinamentoDialog">

		<p:commandButton id="confirmAbbinamento" value="Conferma"
			oncomplete="abbinamentoDialog.hide()"
			action="#{esameCommissioniController.removeAbbinamento}"
			update="listaAbbinamenti" />
		<p:commandButton id="declineAbbinamento" value="Annulla"
			onclick="abbinamentoDialog.hide()" type="button" />

	</p:confirmDialog>

	<!-- Pannello ricerca -->

	<p:panelGrid
		style="width:100%;margin-bottom:7px;border:1px solid #4F4F4F;"
		id="serchPanel">


		<f:facet name="header">
			<p:row>
				<p:column style="text-align:left" colspan="4">
						Ricerca Atto:
			    </p:column>
			</p:row>
		</f:facet>

		<p:row>
			<p:column>

				<div>

					<p:panelGrid style="width:100%;margin-bottom:7px;" id="searchPanel">




						<p:messages id="msgs" />

						<p:row>
							<p:column style="width: 20%;">
								<h:outputLabel for="tipoatto" value="Tipo atto: " />
							</p:column>

							<p:column style="width: 20%;">
								<p:selectOneMenu id="tipoatto"
									value="#{searchAttoController.tipoatto}">
									<f:selectItem itemLabel="Scegli Tipo" itemValue="" />
									<f:selectItems value="#{searchAttoController.tipiAtto}" />
								</p:selectOneMenu>
							</p:column>

							<p:column style="width: 20%;">
								<h:outputLabel for="legislatura" value="Legislatura: " />
							</p:column>

							<p:column style="width: 20%;">
								<p:selectOneMenu id="legislatura"
									value="#{searchAttoController.legislatura}">
									<f:selectItem itemLabel="Scegli Legislatura" itemValue="" />
									<f:selectItems value="#{searchAttoController.legislature}" />
								</p:selectOneMenu>
							</p:column>

							<p:column style="width: 20%;">
								<h:outputLabel for="stato" value="Stato: " />
								<p:selectOneMenu id="stato"
									value="#{searchAttoController.stato}">
									<f:selectItem itemLabel="Scegli Stato" itemValue="" />
									<f:selectItems value="#{searchAttoController.stati}" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column style="width: 20%;">
								<h:outputLabel for="numeroatto" value="Numero Atto: " />
							</p:column>

							<p:column style="width: 20%;">
								<p:inputText id="numeroatto"
									value="#{searchAttoController.numeroAtto}"></p:inputText>
							</p:column>

							<p:column style="width: 20%;">
								<h:outputLabel value="Data Iniziativa " />
							</p:column>
							<p:column style="width: 20%;">
								<h:outputLabel for="datainiziativa_da" value="da: " />
								<p:calendar size="10" locale="it" id="datainiziativa_da"
									value="#{searchAttoController.dataIniziativaDa}" />
							</p:column>
							<p:column style="width: 20%;">
								<h:outputLabel for="datainiziativa_a" value="a: " />
								<p:calendar size="10" locale="it" id="datainiziativa_a"
									value="#{searchAttoController.dataIniziativaA}" />
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputLabel for="numeroprotocollo"
									value="Numero Protocollo: " />
							</p:column>

							<p:column>
								<p:inputText id="numeroprotocollo"
									value="#{searchAttoController.numeroprotocollo}"></p:inputText>
							</p:column>

							<p:column>
								<h:outputLabel for="tipoiniziativa" value="Tipo Iniziativa: " />
							</p:column>

							<p:column>
								<p:selectOneMenu id="tipoiniziativa"
									value="#{searchAttoController.tipoiniziativa}">
									<f:selectItem itemLabel="Scegli Tipo Iniziativa" itemValue="" />
									<f:selectItems value="#{searchAttoController.tipiIniziative}" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputLabel for="numerodcr" value="Numero DCR: " />
							</p:column>

							<p:column>
								<p:inputText id="numerodcr"
									value="#{searchAttoController.numerodcr}"></p:inputText>
							</p:column>

							<p:column>
								<h:outputLabel for="primofirmatario" value="1° Firmatario: " />
							</p:column>

							<p:column>
								<p:selectOneMenu id="primofirmatario"
									value="#{searchAttoController.primofirmatario}">
									<f:selectItem itemLabel="Scegli Primo Firmatario" itemValue="" />
									<f:selectItems value="#{searchAttoController.firmatari}" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputLabel for="oggetto" value="Oggetto: " />
							</p:column>

							<p:column>
								<p:inputText id="oggetto"
									value="#{searchAttoController.oggetto}"></p:inputText>
							</p:column>

							<p:column>
								<h:outputLabel for="firmatario" value="Firmatario: " />
							</p:column>

							<p:column>
								<p:selectOneMenu id="firmatario"
									value="#{searchAttoController.firmatario}">
									<f:selectItem itemLabel="Scegli Firmatario" itemValue="" />
									<f:selectItems value="#{searchAttoController.firmatari}" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

					</p:panelGrid>

				</div>

				<div id="ricercaAvanzataDiv">

					<p:panelGrid style="width:100%;margin-bottom:7px;"
						id="RicercaAvanzataPanel">


						<p:row>
							<p:column style="width: 20%;">

								<h:outputLabel for="tipoChiusura" value="Tipo chiusura: " />

							</p:column>
							<p:column style="width: 20%;">

								<p:selectOneMenu id="tipoChiusura">
									<f:selectItem itemLabel="Scegli Tipo Chiusura" itemValue="" />
									<f:selectItems value="#{searchAttoController.tipiChiusura}" />
								</p:selectOneMenu>

							</p:column>
							<p:column style="width: 20%;">

								<h:outputLabel value="Data pubblicazione: " />



							</p:column>
							<p:column style="width: 20%;">
								<h:outputLabel for="dataPubblicazione_da" value="da: " />
								<p:calendar size="10" locale="it" id="dataPubblicazione_da" />
							</p:column>
							<p:column style="width: 20%;">
								<h:outputLabel for="dataPbblicazione_a" value="a: " />
								<p:calendar size="10" locale="it" id="dataPbblicazione_a" />
							</p:column>

						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="esitoVotoComRef"
									value="Esito voto Com.Ref: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="esitoVotoComRef">
									<f:selectItem
										itemLabel="Scegli Esito Voto Commissione Referente"
										itemValue="" />
									<f:selectItems
										value="#{searchAttoController.esitiVotoCommissioneReferente}" />
								</p:selectOneMenu>

							</p:column>
							<p:column>

								<h:outputLabel value="Data seduta S.C.: " />



							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaSC_da" value="da: " />
								<p:calendar size="10" locale="it" id="dataSedutaSC_da" />
							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaSC_a" value="a: " />
								<p:calendar size="10" locale="it" id="dataSedutaSC_a" />
							</p:column>

						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="esitoVotoAula" value="Esito voto Aula: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="esitoVotoAula">
									<f:selectItem itemLabel="Scegli Esito Voto Aula" itemValue="" />
									<f:selectItems value="#{searchAttoController.esitiVotoAula}" />
								</p:selectOneMenu>

							</p:column>
							<p:column>

								<h:outputLabel value="Data seduta. Comm: " />



							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaComm_da" value="da: " />
								<p:calendar size="10" locale="it" id="dataSedutaComm_da" />
							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaComm_a" value="a: " />
								<p:calendar size="10" locale="it" id="dataSedutaComm_a" />
							</p:column>

						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="commissioneReferente"
									value="Commissione Referente: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="commissioneReferente">
									<f:selectItem itemLabel="Scegli Commissione Referente"
										itemValue="" />
									<f:selectItems
										value="#{searchAttoController.commissioniReferenti}" />
								</p:selectOneMenu>

							</p:column>
							<p:column>

								<h:outputLabel value="Data seduta Aula: " />



							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaAula_da" value="da: " />
								<p:calendar size="10" locale="it" id="dataSedutaAula_da" />
							</p:column>
							<p:column>
								<h:outputLabel for="dataSedutaAula_a" value="a: " />
								<p:calendar size="10" locale="it" id="dataSedutaAula_a" />
							</p:column>

						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="commissioneConsultiva"
									value="Commissione Consultiva: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="commissioneConsultiva">
									<f:selectItem itemLabel="Scegli Commissione Consultiva"
										itemValue="" />
									<f:selectItems
										value="#{searchAttoController.commissioniConsultive}" />
								</p:selectOneMenu>

							</p:column>
							<p:column>

								<h:outputLabel for="relatore" value="Relatore: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="relatoreSearch">
									<f:selectItem itemLabel="Scegli Relatore" itemValue="" />
									<f:selectItems value="#{searchAttoController.relatori}" />
								</p:selectOneMenu>

							</p:column>
						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="redigente" value="Redigente: " />

								<p:selectBooleanCheckbox id="redigente" />
							</p:column>
							<p:column>

								<h:outputLabel for="deliberante" value="Deliberante: " />

								<p:selectBooleanCheckbox id="deliberante" />

							</p:column>
							<p:column>

								<h:outputLabel for="organismoStatutario"
									value="Organismo Statutario: " />

							</p:column>
							<p:column>

								<p:selectOneMenu id="organismoStatutario">
									<f:selectItem itemLabel="Scegli Organismo Statutario"
										itemValue="" />
									<f:selectItems
										value="#{searchAttoController.organismiStatutari}" />
								</p:selectOneMenu>

							</p:column>
						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="numeroLCR" value="Numero LCR: " />

								<p:inputText id="numeroLCR" size="5" maxlength="5" />
							</p:column>
							<p:column>



							</p:column>
							<p:column>

								<h:outputLabel for="soggettoConsultato"
									value="Soggetto consultato: " />

							</p:column>
							<p:column>

								<p:inputText id="soggettoConsultato" />


							</p:column>
						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="numeroLR" value="Numero LR: " />

								<p:inputText id="numeroLR" size="5" maxlength="5" />
							</p:column>
							<p:column>

								<h:outputLabel for="anno" value="Anno: " />
								<p:inputText id="anno" size="4" maxlength="4" />

							</p:column>
							<p:column>



							</p:column>
							<p:column>



							</p:column>
						</p:row>

						<p:row>
							<p:column>

								<h:outputLabel for="abbonamento" value="Abbonamento: " />

								<p:selectBooleanCheckbox id="abbonamento" />
							</p:column>
							<p:column>

								<h:outputLabel for="stralcio" value="Stralcio: " />
								<p:selectBooleanCheckbox id="stralcio" />

							</p:column>
							<p:column colspan="3">

								<h:outputLabel for="emendato" value="Emendato: " />
								<p:selectBooleanCheckbox id="emendato" />
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<h:outputLabel for="rinviato" value="Rinviato: " />
								<p:selectBooleanCheckbox id="rinviato" />
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<h:outputLabel for="sospeso" value="Sospeso: " />
								<p:selectBooleanCheckbox id="sospeso" />

							</p:column>

						</p:row>
						<p:row>
							<p:column>

								<p:commandButton type="button" outcome="productDetail"
									value="Ricerca semplice"
									onclick="hidePanel('ricercaAvanzataDiv', 'ricercaAvanzataButton')">

								</p:commandButton>
							</p:column>
						</p:row>

					</p:panelGrid>

				</div>


				<p:panelGrid>


					<p:row>

						<p:column>
							<div id="ricercaAvanzataButton">
								<p:commandButton type="button" outcome="productDetail"
									value="Ricerca avanzata"
									onclick="showPanel('ricercaAvanzataDiv', 'ricercaAvanzataButton')" />
							</div>


						</p:column>
					</p:row>
					<p:row>
						<p:column colspan="3">

							<p:commandButton value="Cerca" update="listaAtti"
								id="btncercaatto_cerca"
								actionListener="#{searchAttoController.searchAtti()}" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<h:commandLink value="Esporta Excel" id="btncercaatto_exl">
								<p:dataExporter type="xls" target="listaAtti"
									fileName="lista_atti" />
							</h:commandLink>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<p:commandButton value="Reimposta" update="searchPanel"
								id="btncercaatto_reset" />



							<!-- 
					 
             <p:commandButton value="Ricerca Avanzata" update="listaAtti" id="btncercaatto_ricavnz"  actionListener="" />  
              
              <p:commandButton value="Reimposta" update="searchPanel" id="btncercaatto_reset" actionListener="" />
              
-->















						</p:column>


					</p:row>


					<!-- <h:outputText style="color: #BBBB">Qui Maschera di ricerca</h:outputText> -->

				</p:panelGrid>
			</p:column>
		</p:row>
	</p:panelGrid>

	<!-- Pannello ricerca end -->

	<h3>Risultati ricerca</h3>

	<p:dataTable id="listaAtti" var="atto"
		value="#{searchAttoController.lazyAttoModel}" rows="10"
		paginator="true"
		paginatorTemplate="{FirstPageLink} {PreviousPageLink} {NextPageLink}"
		paginatorAlwaysVisible="false" paginatorPosition="bottom">
		<p:column>
			<f:facet name="header">Tipo</f:facet>
			<h:outputText value="#{atto.tipo}" />
		</p:column>

		<p:column headerText="N.Atto">
			<c:set value="#{atto.id}" var="idAttoParam" />
			<p:commandLink
				action="#{searchAttoController.attoDetail(idAttoParam)}"
				update="listaAtti">
				<h:outputText value="#{atto.numeroAtto}" />
				<!-- <f:param name="numeroatto" value="#{atto.numeroAtto}" /> -->
			</p:commandLink>
		</p:column>
		<p:column headerText="N° Protocollo">
			<h:outputText value="#{atto.numeroProtocollo}" />
		</p:column>
		<p:column headerText="Oggetto">
			<h:outputText value="#{atto.oggetto}" />
		</p:column>
		<p:column headerText="Azioni">
			<c:set value="#{atto.id}" var="idAttoParam" />
			<p:commandButton value="Mostra dettagli Atto"
				action="#{searchAttoController.attoDetail(idAttoParam)}"
				update="listaAtti" icon="detail-icon" />	
				&nbsp; &nbsp; &nbsp;
			<p:commandButton value="Abbina" id="addAbbinamento"
				action="#{esameCommissioniController.addAbbinamento(idAttoParam)}"
				update=":presAssForm:tabView:listaAbbinamenti, :presAssForm:tabView:abbinamentiMsg, :presAssForm:tabView:dettagliabbinamentopanel"
				icon="new-icon" />
		</p:column>
	</p:dataTable>

	<h3>Atti abbinati</h3>


	<p:row>
		<p:column colspan="5">

			<h:dataTable id="listaAbbinamenti"
				value="#{esameCommissioniController.abbinamentiList}"
				var="abbinamento" styleClass="generalInfoTab">

				<h:column>
					<f:facet name="header">Mostra sintesi</f:facet>

					<p:commandButton
						update=":presAssForm:tabView:dettagliabbinamentopanel"
						id="cmdBtn_#{abbinamento.atto.id}" icon="detail-icon"
						action="#{esameCommissioniController.showAbbinamentoDetail}">

						<f:setPropertyActionListener value="#{abbinamento.atto.id}"
							target="#{esameCommissioniController.idAbbinamentoSelected}" />
					</p:commandButton>
				</h:column>

				<h:column>
					<f:facet name="header">Tipo Atto</f:facet>
							#{abbinamento.atto.tipoAtto}
    			       </h:column>

				<h:column>
					<f:facet name="header">N. Atto</f:facet>
					#{abbinamento.atto.numeroAtto}
				</h:column>

				<h:column>
					<f:facet name="header">Data abbinamento</f:facet>
					<h:outputText value="#{abbinamento.dataAbbinamento}">
						<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
					</h:outputText>

				</h:column>

				<h:column>
					<f:facet name="header">Data disabbinamento</f:facet>
					<h:outputText value="#{abbinamento.dataDisabbinamento}">
						<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
					</h:outputText>

				</h:column>

				<h:column>
					<f:facet name="header">Azioni</f:facet>

					<p:commandButton oncomplete="abbinamentoDialog.show()"
						icon="delete-icon">

						<f:setPropertyActionListener value="#{abbinamento.atto.id}"
							target="#{esameCommissioniController.abbinamentoToDelete}" />
					</p:commandButton>
				</h:column>

			</h:dataTable>
		</p:column>
	</p:row>


	<p:fieldset legend="Dettagli abbinamento" collapsed="false"
		toggleable="true" toggleSpeed="500">
		<p:panelGrid styleClass="infoTable" id="dettagliabbinamentopanel">
			<p:row>
				<p:column>
					<h3>Atto N°
						#{esameCommissioniController.abbinamentoSelected.atto.numeroAtto}</h3>
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<h:outputText style="font-weight: bold;" value="Tipo testo: " />
				</p:column>
				<p:column>
					<p:selectOneMenu value="#{esameCommissioniController.tipoTesto}">
						<f:selectItem itemLabel="Scegli testo" itemValue="" />
						<f:selectItem itemLabel="Testo base" itemValue="Testo base" />
						<f:selectItem itemLabel="Testo modificato"
							itemValue="Testo modificato" />
					</p:selectOneMenu>
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<b> <h:outputLabel for="dataabbinamento"
							value="Data abbinamento: " />
					</b>
				</p:column>
				<p:column>
					<p:calendar size="10" locale="it" id="dataabbinamento"
						value="#{esameCommissioniController.dataAbbinamento}" />
				</p:column>
				<p:column>
					<p:commandButton value="Conferma Abbinamento"
						update="listaAbbinamenti, abbinamentiMsg"
						action="#{esameCommissioniController.salvaAbbinamento}" />
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<b> <h:outputLabel for="datadisabbinamento"
							value="Data disabbinamento: " />
					</b>
				</p:column>
				<p:column>
					<p:calendar size="10" locale="it" id="datadisabbinamento"
						value="#{esameCommissioniController.dataDisabbinamento}" />
				</p:column>
				<p:column>
					<p:commandButton value="Conferma Disabbinamento"
						update="listaAbbinamenti"
						action="#{esameCommissioniController.salvaDisabbinamento}" />
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<h:outputText style="font-weight: bold;" value="Note: " />
				</p:column>
				<p:column colspan="3">
					<p:inputTextarea rows="2" cols="82"
						value="#{esameCommissioniController.noteAbbinamento}" />
				</p:column>
			</p:row>
		</p:panelGrid>
	</p:fieldset>

	<p:row>
		<p:column>
			<p>
				<h:outputText style="font-weight: bold;"
					value="Modifica oggetto dell'atto corrente: " />
			</p>
		</p:column>
		<p:column colspan="3">
			<p:inputTextarea rows="2" cols="82"
				value="#{esameCommissioniController.oggettoAttoCorrente}" />
		</p:column>
	</p:row>

</p:fieldset>
<!-- -->
</html>