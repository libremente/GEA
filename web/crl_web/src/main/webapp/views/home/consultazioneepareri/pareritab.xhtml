<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">


<p:fieldset legend="Pareri" toggleable="true" toggleSpeed="500">

	<p:panelGrid styleClass="infoTable" id="pareripanel">
		<p:row>
			<p:column colspan="5">

				<p:growl id="pareriMsg" showDetail="true" sticky="false" />

				<h:dataTable id="listaPareri"
					value="#{consultazionePareriController.pareriList}" var="parere"
					styleClass="generalInfoTab grey-text">

					<h:column>
						<f:facet name="header">Mostra dettaglio</f:facet>
						<p:commandButton value="Mostra dettaglio" icon="detail-icon"
							action="#{consultazionePareriController.showParereDetail}"
							update=":consultazioniPareriForm:tabView:dettagliparerepanel">
							<f:setPropertyActionListener value="#{parere.descrizione}"
								target="#{consultazionePareriController.descrizioneParereSelected}" />
						</p:commandButton>
					</h:column>

					<h:column>
						<f:facet name="header">Organismo Statutario</f:facet>
							#{parere.descrizione}
    			       </h:column>

					<h:column>
						<f:facet name="header">Richiesto</f:facet>
						<h:outputText value="#{parere.dataAssegnazione}">
							<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
						</h:outputText>

					</h:column>

					<h:column>
						<f:facet name="header">Ricevuto</f:facet>
						<h:outputText value="#{parere.dataRicezioneOrgano}">
							<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
						</h:outputText>

					</h:column>

					<h:column>
						<f:facet name="header">Esito</f:facet>
							#{parere.esito}
						</h:column>

					<h:column>
						<f:facet name="header">Allegati</f:facet>

					</h:column>



				</h:dataTable>
			</p:column>
		</p:row>

		<p:row>
			<p:column colspan="6">
				<p:fieldset legend="Dettagli parere" collapsed="false"
					toggleable="true" toggleSpeed="500">
					<p:panelGrid styleClass="infoTable" id="dettagliparerepanel">
						<p:row>
							<p:column>
								<h:outputText style="font-weight: bold;"
									value="Organismo Statutario: " />
							</p:column>
							<p:column>
								<p:inputText
									value="#{consultazionePareriController.parereSelected.descrizione}"
									readonly="true" />
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputText style="font-weight: bold;"
									value="Data Assegnazione: " />
							</p:column>
							<p:column>
								<p:inputText size="10"
									value="#{consultazionePareriController.parereSelected.dataAssegnazione}"
									readonly="true">
									<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
								</p:inputText>
							</p:column>
							<p:column>
								<b> <h:outputLabel for="dataricezioneorgano"
										value="Data ricezione organo: " />
								</b>
							</p:column>
							<p:column>
								<p:calendar size="10" locale="it" id="dataricezioneorgano"
									value="#{consultazionePareriController.dataRicezioneOrgano}">
									<p:ajax event="dateSelect"
										listener="#{consultazionePareriController.updatePareriHandler}" />
								</p:calendar>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<b> <h:outputLabel for="dataricezioneparere"
										value="Data ricezione parere: " />
								</b>
							</p:column>
							<p:column>
								<p:calendar size="10" locale="it" id="dataricezioneparere"
									value="#{consultazionePareriController.dataRicezioneParere}">
									<p:ajax event="dateSelect"
										listener="#{consultazionePareriController.updatePareriHandler}" />
								</p:calendar>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputText style="font-weight: bold;" value="Esito: " />
							</p:column>
							<p:column>
								<p:selectOneMenu value="#{consultazionePareriController.esito}">
									<f:selectItem itemLabel="Scegli esito" itemValue="" />
									<f:selectItem itemLabel="Positivo" itemValue="Positivo" />
									<f:selectItem itemLabel="Positivo condizionato"
										itemValue="Positivo condizionato" />
									<f:selectItem itemLabel="Negativo" itemValue="Negativo" />
									<p:ajax event="change"
										listener="#{consultazionePareriController.updatePareriHandler}" />
								</p:selectOneMenu>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputText style="font-weight: bold;" value="Note: " />
							</p:column>
							<p:column colspan="3">
								<p:inputTextarea rows="2" cols="82"
									value="#{consultazionePareriController.noteParere}">
									<p:ajax event="change"
										listener="#{consultazionePareriController.updatePareriHandler}" />
								</p:inputTextarea>
							</p:column>
						</p:row>

						<p:row>
							<p:column colspan="4">
								<table class="generalInfoTab grey-text"
									id="documentazioneallegatatab" style="width: 100%;" border="0">
									<thead>
										<th colspan="2">Documentazione allegata</th>
										<th>Documento</th>
										<th>Pubblico</th>
									</thead>

									<!-- TODO: 
							da implementare la cencellazione e l'aggiunta delle righe sugli opportuni tasti già inseriti
							il campo "download" è da implementare con l'opportuno tag <p:filedownload/> -->

									<tbody>
										<tr>
											<td align="left" colspan="2">Allegato 1</td>
											<td align="left"><h:commandLink>
													<h:outputText value="download" />
												</h:commandLink></td>
											<td align="left"><p:selectBooleanCheckbox /></td>

										</tr>

										<tr>
											<td align="left" colspan="2">Allegato 2</td>
											<td align="left"><h:commandLink>
													<h:outputText value="download" />
												</h:commandLink></td>
											<td align="left"><p:selectBooleanCheckbox /></td>

										</tr>

									</tbody>
								</table>
							</p:column>
						</p:row>
						<p:row>
							<p:column>
								<h:graphicImage alt="add" value="/resources/img/add.png" />
							</p:column>
							<p:column>
								<p:fileUpload mode="simple" />
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<p:commandButton value="Salva"
									action="#{consultazionePareriController.salvaParere}"
									update="pareriMsg, listaPareri" />
							</p:column>
						</p:row>

					</p:panelGrid>
				</p:fieldset>
			</p:column>
		</p:row>

	</p:panelGrid>
</p:fieldset>
</html>