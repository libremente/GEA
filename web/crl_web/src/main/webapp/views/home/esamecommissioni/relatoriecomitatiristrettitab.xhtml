<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<pe:tooltip value="Click per Espandere / Comprimere"
	forSelector="legend" shared="true" targetPosition="top center"
	position="left center" />



<p:panelGrid styleClass="infoTable" id="relatoriecomitatiristrettipanel">
	<p:row>
		<p:column>


			<!-- Messaggio azioni -->
			<p:growl id="comitatiMsg" showDetail="true" sticky="false" />



			<!-- Confirm dialog -->
			<p:confirmDialog id="confirmRelatoreDialog"
				message="Sei sicuro di voler eliminare il relatore ?"
				header="Cancellazione Relatore" severity="alert"
				widgetVar="relatoreDialog">

				<p:commandButton id="confirmRelatore" value="Conferma"
					oncomplete="relatoreDialog.hide()"
					action="#{esameCommissioniController.removeRelatore}"
					update="listaRelatori" />
				<p:commandButton id="declineRelatore" value="Annulla"
					onclick="relatoreDialog.hide()" type="button" />

			</p:confirmDialog>

			<p:confirmDialog id="confirmComponenteDialog"
				message="Sei sicuro di voler eliminare il componente ?"
				header="Cancellazione Componente" severity="alert"
				widgetVar="componenteDialog">

				<p:commandButton id="confirmRelatoreComponente" value="Conferma"
					oncomplete="componenteDialog.hide()"
					action="#{esameCommissioniController.removeComponente}"
					update="listaComponentiComitato" />
				<p:commandButton id="declineComponente" value="Annulla"
					onclick="componenteDialog.hide()" type="button" />

			</p:confirmDialog>

			<p:confirmDialog id="confirmTestoComitatoDialog"
				message="Sei sicuro di voler eliminare l'allegato ?"
				header="Cancellazione Testo Comitato" severity="alert"
				widgetVar="testoComitatoDialog">

				<p:commandButton id="confirmTestoComitatoComponente"
					value="Conferma" oncomplete="testoComitatoDialog.hide()"
					action="#{esameCommissioniController.removeTestoComitato}"
					update="listaTestiComitatoRistretto" />
				<p:commandButton id="declineTestoComitato" value="Annulla"
					onclick="testoComitatoDialog.hide()" type="button" />

			</p:confirmDialog>



			<b> <h:outputLabel for="datapresaincarico"
					value="Data presa in carico: " />
			</b>
		</p:column>
		<p:column>
			<p:calendar size="10" locale="it" id="datapresaincarico"
				update="comitatiMsg"
				value="#{esameCommissioniController.dataPresaInCarico}">
				<p:ajax event="dateSelect"
					listener="#{esameCommissioniController.updatePresaInCaricoHandler}" />
			</p:calendar>
					&nbsp;
					<p:commandButton value="Presa in Carico"
				action="#{esameCommissioniController.presaInCarico}"
				update="dataScadenzaMessage, dataScadenzaReadOnly" />
		</p:column>
		<p:column></p:column>
		<p:column></p:column>
		<p:column></p:column>
	</p:row>
	<p:row>
		<p:column>
			<h:outputText style="font-weight: bold;" value="Materia: " />
		</p:column>
		<p:column>
			<p:inputText id="inputmateria"
				value="#{esameCommissioniController.materia}">
				<p:ajax event="change"
					listener="#{esameCommissioniController.updatePresaInCaricoHandler}" />
			</p:inputText>
		</p:column>
	</p:row>
	<p:row>
		<p:column>
			<b> <h:outputLabel for="datascadenza" value="Data scadenza: " />
			</b>
		</p:column>
		<p:column>
			<p:calendar size="10" locale="it" id="datascadenza"
				value="#{esameCommissioniController.dataScadenza}">
				<p:ajax event="dateSelect"
					listener="#{esameCommissioniController.updatePresaInCaricoHandler}" />
			</p:calendar>
		</p:column>
	</p:row>
</p:panelGrid>

<p:fieldset legend="Gestione Relatori" collapsed="false"
	toggleable="true" toggleSpeed="500">


	<p:panelGrid styleClass="infoTable" id="firmataripanel">
		<p:row>
			<p:column colspan="6">
				<p:panelGrid id="addRelatoriPanel" styleClass="tableAppend">

					<f:facet name="header">
						<p:row>
							<p:column>Relatore</p:column>
							<p:column>Data nomina</p:column>
							<p:column>Data uscita</p:column>
							<p:column></p:column>
						</p:row>
					</f:facet>
					<p:row>
						<p:column>
							<p:selectOneMenu id="relatore"
								value="#{esameCommissioniController.nomeRelatore}">
								<f:selectItem itemLabel="Scegli Relatore" itemValue="" />
								<f:selectItems value="#{esameCommissioniController.relatori}" />
							</p:selectOneMenu>
						</p:column>


						<p:column>
							<p:calendar size="10" locale="it_IT" id="dataNominaRelatore"
								pattern="dd/MM/yyyy"
								value="#{esameCommissioniController.dataNominaRelatore}" />
						</p:column>

						<p:column>
							<p:calendar size="10" locale="it_IT" id="dataUscitaRelatore"
								pattern="dd/MM/yyyy"
								value="#{esameCommissioniController.dataUscitaRelatore}" />
						</p:column>

						<p:column>
							<p:commandButton value="Aggiungi"
								action="#{esameCommissioniController.addRelatore}"
								id="addRelatore" update="listaRelatori, comitatiMsg"
								icon="new-icon" />
						</p:column>

					</p:row>
				</p:panelGrid>


			</p:column>
		</p:row>

		<p:row>
			<p:column colspan="6">

				<p:dataTable id="listaRelatori"
					value="#{esameCommissioniController.relatoriList}" var="relatore"
					styleClass="generalInfoTab grey-text" editable="true">

					<p:column headerText="Relatore">

						<h:outputText value="#{relatore.descrizione}" />
					</p:column>

					<p:column headerClass="Data nomina">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{relatore.dataNomina}">
									<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar size="10" locale="it_IT" pattern="dd/MM/yyyy"
									value="#{relatore.dataNomina}" />
							</f:facet>
						</p:cellEditor>

					</p:column>

					<p:column headerText="Data uscita">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{relatore.dataUscita}">
									<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar size="10" locale="it_IT" pattern="dd/MM/yyyy"
									value="#{relatore.dataUscita}" />
							</f:facet>
						</p:cellEditor>



					</p:column>

					<p:column headerText="Elimina">
						<f:facet name="header">Elimina</f:facet>

						<p:commandButton oncomplete="relatoreDialog.show()"
							icon="delete-icon">

							<f:setPropertyActionListener value="#{relatore.descrizione}"
								target="#{esameCommissioniController.relatoreToDelete}" />
						</p:commandButton>
					</p:column>

					<p:column headerText="Modifica">
						<p:rowEditor />
					</p:column>

				</p:dataTable>
			</p:column>
		</p:row>
		<p:row>
			<p:column>
				<p:commandButton value="Conferma Relatori"
					action="#{esameCommissioniController.confermaRelatori}"
					update="comitatiMsg" />
			</p:column>
		</p:row>


	</p:panelGrid>

</p:fieldset>
<p:fieldset legend="Gestione Comitati Ristretti" collapsed="false"
	toggleable="true" toggleSpeed="500">
	<p:panelGrid styleClass="infoTable" id="gestionecomitatiristrettipanel">
		<p:row>
			<p:column>
				<h:outputText style="font-weight: bold;"
					value="Presenza Comitato Ristretto: " />
			</p:column>
			<p:column>
				<p:selectBooleanCheckbox
					value="#{esameCommissioniController.presenzaComitatoRistretto}">
					<p:ajax event="change"
						listener="#{esameCommissioniController.updateComitatoRistrettoHandler}" />
				</p:selectBooleanCheckbox>
			</p:column>
			<p:column>

				<b> <h:outputLabel for="dataistituzionecomitato"
						value="Data istituzione Comitato: " />
				</b>
			</p:column>
			<p:column>
				<p>
					<p:calendar size="10" locale="it" id="dataistituzionecomitato"
						value="#{esameCommissioniController.dataIstituzioneComitato}">
						<p:ajax event="dateSelect"
							listener="#{esameCommissioniController.updateComitatoRistrettoHandler}" />
					</p:calendar>
				</p>
			</p:column>

		</p:row>
		<p:row>
			<p:column colspan="6">
				<p:panelGrid id="addComponentiComitatoPanel"
					styleClass="tableAppend">

					<f:facet name="header">
						<p:row>
							<p:column>Componente</p:column>
							<p:column>Data nomina</p:column>
							<p:column>Coordinatore</p:column>
							<p:column>Data uscita</p:column>
							<p:column></p:column>
						</p:row>
					</f:facet>
					<p:row>
						<p:column>
							<p:selectOneMenu id="componente"
								value="#{esameCommissioniController.nomeComponente}">
								<f:selectItem itemLabel="Scegli Componente" itemValue="" />
								<f:selectItems
									value="#{esameCommissioniController.membriComitato}" />
							</p:selectOneMenu>
						</p:column>


						<p:column>
							<p:calendar size="10" locale="it_IT" id="dataNominaComponente"
								pattern="dd/MM/yyyy"
								value="#{esameCommissioniController.dataNominaComponente}" />
						</p:column>

						<p:column>
							<p:selectBooleanCheckbox
								value="#{esameCommissioniController.coordinatore}">
							</p:selectBooleanCheckbox>
						</p:column>

						<p:column>
							<p:calendar size="10" locale="it_IT" id="dataUscitaComponente"
								pattern="dd/MM/yyyy"
								value="#{esameCommissioniController.dataUscitaComponente}" />
						</p:column>

						<p:column>
							<p:commandButton value="Aggiungi"
								action="#{esameCommissioniController.addComponente}"
								id="addComponente" update="listaComponentiComitato, comitatiMsg"
								icon="new-icon" />
						</p:column>

					</p:row>
				</p:panelGrid>


			</p:column>
		</p:row>

		<p:row>
			<p:column colspan="6">

				<p:dataTable id="listaComponentiComitato"
					value="#{esameCommissioniController.membriComitatoList}"
					var="componente" styleClass="generalInfoTab grey-text"
					editable="true">

					<p:column headerText="Componenti">
						
							#{componente.descrizione}
    			       </p:column>

					<p:column headerText="Data nomina">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{componente.dataNomina}">
									<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar size="10" locale="it_IT" pattern="dd/MM/yyyy"
									value="#{componente.dataNomina}" />
							</f:facet>
						</p:cellEditor>


					</p:column>

					<p:column headerText="Coordinatore">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="si" rendered="#{componente.coordinatore}" />
								<h:outputText value="no" rendered="#{!componente.coordinatore}" />
							</f:facet>
							<f:facet name="input">
								<p:selectBooleanCheckbox value="#{componente.coordinatore}" />
							</f:facet>
						</p:cellEditor>


					</p:column>

					<p:column headerText="Data uscita">

						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{componente.dataUscita}">
									<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar size="10" locale="it_IT" pattern="dd/MM/yyyy"
									value="#{componente.dataUscita}" />
							</f:facet>
						</p:cellEditor>

					</p:column>

					<p:column headerText="Elimina">


						<p:commandButton oncomplete="componenteDialog.show()"
							icon="delete-icon">

							<f:setPropertyActionListener value="#{componente.descrizione}"
								target="#{esameCommissioniController.componenteToDelete}" />
						</p:commandButton>
					</p:column>

					<p:column headerText="Modifica">
						<p:rowEditor />
					</p:column>

				</p:dataTable>
			</p:column>
		</p:row>
		<p:row>
			<p:column>
				<p:commandButton value="Conferma Comitato"
					action="#{esameCommissioniController.confermaComitatoRistretto}"
					update="comitatiMsg" />
			</p:column>
		</p:row>
		<p:row>
			<p:column>
					&nbsp;
				</p:column>
		</p:row>
		<p:row>
			<!-- <p:column>
					<h:graphicImage alt="add" value="/resources/img/add.png" />
				</p:column>-->
			<p:column colspan="3">
				<p:fileUpload label="Carica File"
					fileUploadListener="#{esameCommissioniController.uploadTestoComitatoRistretto}"
					mode="advanced" auto="true"
					update="listaTestiComitatoRistretto ,comitatiMsg" />
			</p:column>
		</p:row>
		<p:row>
			<p:column colspan="4">

				<h:dataTable id="listaTestiComitatoRistretto"
					value="#{esameCommissioniController.testiComitatoRistrettoList}"
					var="testoComitato" styleClass="generalInfoTab grey-text">

					<h:column>
						<f:facet name="header">Data Seduta</f:facet>
							#{testoComitato.dataSeduta}
						</h:column>

					<h:column>
						<f:facet name="header">Testo Dell'Atto</f:facet>
							#{testoComitato.nome}
						</h:column>

					<h:column>
						<f:facet name="header">Formato</f:facet>
						<h:outputText
							value="#{fn:substring(testoComitato.nome, fn:indexOf(testoComitato.nome,'.')+1 ,fn:length(testoComitato.nome) )}" />

					</h:column>

					<h:column>
						<f:facet name="header">Pubblico</f:facet>
						<h:outputText value="si" rendered="#{testoComitato.pubblico}" />
						<h:outputText value="no" rendered="#{!testoComitato.pubblico}" />
					</h:column>

					<h:column>
						<f:facet name="header">Elimina</f:facet>
						<p:commandButton oncomplete="testoComitatoDialog.show()"
							icon="delete-icon">

							<f:setPropertyActionListener value="#{testoComitato.id}"
								target="#{esameCommissioniController.testoComitatoToDelete}" />
						</p:commandButton>
					</h:column>


				</h:dataTable>
			</p:column>
		</p:row>
		<p:row>
			<p:column>
				<b> <h:outputLabel for="datafinelavori"
						value="Data Fine Lavori: " />
				</b>
			</p:column>
			<p:column>
				<p>
					<p:calendar size="10" locale="it" id="datafinelavori"
						value="#{esameCommissioniController.dataFineLavori}">
						<p:ajax event="dateSelect"
							listener="#{esameCommissioniController.updateRelatoriComitatiRistrettiHandler}" />
					</p:calendar>
				</p>
			</p:column>
		</p:row>
		<p:row>
			<p:column>
				<p:commandButton value="Conferma Fine Lavori"
					action="#{esameCommissioniController.confermaFineLavori}"
					update="comitatiMsg" />
			</p:column>
		</p:row>
	</p:panelGrid>
</p:fieldset>
</html>