<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:of="http://omnifaces.org/functions">

<script>
	hidePanel('ricercaAvanzataDiv', 'ricercaAvanzataButton');
	jQuery(function() {
        jQuery('.ui-datatable tbody').sortable();
    });
</script>

<p:panelGrid styleClass="infoTable" id="inserisciODGGrid">
	<p:row>
		<p:column>

			<!-- Messaggio azioni -->
			<p:growl id="inserisciOdgMsg" showDetail="true" sticky="false" />

			<!-- Confirm dialog -->
			<p:confirmDialog id="confirmAttoTrattatoDialog"
				message="Sei sicuro di voler eliminare l'atto trattato ?"
				header="Cancellazione Atto Trattato" severity="alert"
				widgetVar="attoTrattatoDialog">

				<p:commandButton id="confirmAttoTrattato" value="Conferma"
					oncomplete="attoTrattatoDialog.hide()"
					action="#{gestioneSeduteController.removeAttoTrattato}"
					update="listaAttiTrattati" />
				<p:commandButton id="declineAttoTrattato" value="Annulla"
					onclick="attoTrattatoDialog.hide()" type="button" />

			</p:confirmDialog>


			<!-- Pannello ricerca -->

			<p:panelGrid
				style="width:100%;margin-bottom:7px;border:1px solid #4F4F4F;"
				id="serchPanel">


				<f:facet name="header">
					<p:row>
						<p:column style="text-align:left" colspan="4">
						Ricerca Atto:
			    </p:column>
					</p:row>
				</f:facet>

				<p:row>
					<p:column>

						<div>

							<p:panelGrid style="width:100%;margin-bottom:7px;"
								id="searchPanel">

								<p:messages id="msgs" />

								<p:row>
									<p:column style="width: 20%;">
										<h:outputLabel for="tipoatto" value="Tipo atto: " />
									</p:column>

									<p:column style="width: 20%;">
										<p:selectOneMenu id="tipoatto"
											value="#{searchAttoController.tipoatto}">
											<f:selectItem itemLabel="Scegli Tipo" itemValue="" />
											<f:selectItems value="#{searchAttoController.tipiAtto}" />
										</p:selectOneMenu>
									</p:column>

									<p:column style="width: 20%;">
										<h:outputLabel for="legislatura" value="Legislatura: " />
									</p:column>

									<p:column style="width: 20%;">
										<p:selectOneMenu id="legislatura"
											value="#{searchAttoController.legislatura}">
											<f:selectItem itemLabel="Scegli Legislatura" itemValue="" />
											<f:selectItems value="#{searchAttoController.legislature}" />
										</p:selectOneMenu>
									</p:column>

									<p:column style="width: 20%;">
										<h:outputLabel for="stato" value="Stato: " />
										<p:selectOneMenu id="stato"
											value="#{searchAttoController.stato}">
											<f:selectItem itemLabel="Scegli Stato" itemValue="" />
											<f:selectItems value="#{searchAttoController.stati}" />
										</p:selectOneMenu>
									</p:column>
								</p:row>

								<p:row>
									<p:column style="width: 20%;">
										<h:outputLabel for="numeroatto" value="Numero Atto: " />
									</p:column>

									<p:column style="width: 20%;">
										<p:inputText id="numeroatto"
											value="#{searchAttoController.numeroAtto}"></p:inputText>
									</p:column>

									<p:column style="width: 20%;">
										<h:outputLabel value="Data Iniziativa " />
									</p:column>
									<p:column style="width: 20%;">
										<h:outputLabel for="datainiziativa_da" value="da: " />
										<p:calendar size="10" locale="it" id="datainiziativa_da"
											value="#{searchAttoController.dataIniziativaDa}" />
									</p:column>
									<p:column style="width: 20%;">
										<h:outputLabel for="datainiziativa_a" value="a: " />
										<p:calendar size="10" locale="it" id="datainiziativa_a"
											value="#{searchAttoController.dataIniziativaA}" />
									</p:column>
								</p:row>

								<p:row>
									<p:column>
										<h:outputLabel for="numeroprotocollo"
											value="Numero Protocollo: " />
									</p:column>

									<p:column>
										<p:inputText id="numeroprotocollo"
											value="#{searchAttoController.numeroprotocollo}"></p:inputText>
									</p:column>

									<p:column>
										<h:outputLabel for="tipoiniziativa" value="Tipo Iniziativa: " />
									</p:column>

									<p:column>
										<p:selectOneMenu id="tipoiniziativa"
											value="#{searchAttoController.tipoiniziativa}">
											<f:selectItem itemLabel="Scegli Tipo Iniziativa" itemValue="" />
											<f:selectItems value="#{searchAttoController.tipiIniziative}" />
										</p:selectOneMenu>
									</p:column>
								</p:row>

								<p:row>
									<p:column>
										<h:outputLabel for="numerodcr" value="Numero DCR: " />
									</p:column>

									<p:column>
										<p:inputText id="numerodcr"
											value="#{searchAttoController.numerodcr}"></p:inputText>
									</p:column>

									<p:column>
										<h:outputLabel for="primofirmatario" value="1Â° Firmatario: " />
									</p:column>

									<p:column>
										<p:selectOneMenu id="primofirmatario"
											value="#{searchAttoController.primofirmatario}">
											<f:selectItem itemLabel="Scegli Primo Firmatario"
												itemValue="" />
											<f:selectItems value="#{searchAttoController.firmatari}" />
										</p:selectOneMenu>
									</p:column>
								</p:row>

								<p:row>
									<p:column>
										<h:outputLabel for="oggetto" value="Oggetto: " />
									</p:column>

									<p:column>
										<p:inputText id="oggetto"
											value="#{searchAttoController.oggetto}"></p:inputText>
									</p:column>

									<p:column>
										<h:outputLabel for="firmatario" value="Firmatario: " />
									</p:column>

									<p:column>
										<p:selectOneMenu id="firmatario"
											value="#{searchAttoController.firmatario}">
											<f:selectItem itemLabel="Scegli Firmatario" itemValue="" />
											<f:selectItems value="#{searchAttoController.firmatari}" />
										</p:selectOneMenu>
									</p:column>
								</p:row>
							</p:panelGrid>
						</div>


						<div id="ricercaAvanzataDiv">

							<p:panelGrid style="width:100%;margin-bottom:7px;"
								id="RicercaAvanzataPanel">


								<p:row>
									<p:column style="width: 20%;">

										<h:outputLabel for="tipoChiusura" value="Tipo chiusura: " />

									</p:column>
									<p:column style="width: 20%;">

										<p:selectOneMenu id="tipoChiusura">
											<f:selectItem itemLabel="Scegli Tipo Chiusura" itemValue="" />
											<f:selectItems value="#{searchAttoController.tipiChiusura}" />
										</p:selectOneMenu>

									</p:column>
									<p:column style="width: 20%;">

										<h:outputLabel value="Data pubblicazione: " />



									</p:column>
									<p:column style="width: 20%;">
										<h:outputLabel for="dataPubblicazione_da" value="da: " />
										<p:calendar size="10" locale="it" id="dataPubblicazione_da" />
									</p:column>
									<p:column style="width: 20%;">
										<h:outputLabel for="dataPbblicazione_a" value="a: " />
										<p:calendar size="10" locale="it" id="dataPbblicazione_a" />
									</p:column>

								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="esitoVotoComRef"
											value="Esito voto Com.Ref: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="esitoVotoComRef">
											<f:selectItem
												itemLabel="Scegli Esito Voto Commissione Referente"
												itemValue="" />
											<f:selectItems
												value="#{searchAttoController.esitiVotoCommissioneReferente}" />
										</p:selectOneMenu>

									</p:column>
									<p:column>

										<h:outputLabel value="Data seduta S.C.: " />



									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaSC_da" value="da: " />
										<p:calendar size="10" locale="it" id="dataSedutaSC_da" />
									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaSC_a" value="a: " />
										<p:calendar size="10" locale="it" id="dataSedutaSC_a" />
									</p:column>

								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="esitoVotoAula" value="Esito voto Aula: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="esitoVotoAula">
											<f:selectItem itemLabel="Scegli Esito Voto Aula" itemValue="" />
											<f:selectItems value="#{searchAttoController.esitiVotoAula}" />
										</p:selectOneMenu>

									</p:column>
									<p:column>

										<h:outputLabel value="Data seduta. Comm: " />



									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaComm_da" value="da: " />
										<p:calendar size="10" locale="it" id="dataSedutaComm_da" />
									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaComm_a" value="a: " />
										<p:calendar size="10" locale="it" id="dataSedutaComm_a" />
									</p:column>

								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="commissioneReferente"
											value="Commissione Referente: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="commissioneReferente">
											<f:selectItem itemLabel="Scegli Commissione Referente"
												itemValue="" />
											<f:selectItems
												value="#{searchAttoController.commissioniReferenti}" />
										</p:selectOneMenu>

									</p:column>
									<p:column>

										<h:outputLabel value="Data seduta Aula: " />



									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaAula_da" value="da: " />
										<p:calendar size="10" locale="it" id="dataSedutaAula_da" />
									</p:column>
									<p:column>
										<h:outputLabel for="dataSedutaAula_a" value="a: " />
										<p:calendar size="10" locale="it" id="dataSedutaAula_a" />
									</p:column>

								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="commissioneConsultiva"
											value="Commissione Consultiva: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="commissioneConsultiva">
											<f:selectItem itemLabel="Scegli Commissione Consultiva"
												itemValue="" />
											<f:selectItems
												value="#{searchAttoController.commissioniConsultive}" />
										</p:selectOneMenu>

									</p:column>
									<p:column>

										<h:outputLabel for="relatore" value="Relatore: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="relatore">
											<f:selectItem itemLabel="Scegli Relatore" itemValue="" />
											<f:selectItems value="#{searchAttoController.relatori}" />
										</p:selectOneMenu>

									</p:column>
								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="redigente" value="Redigente: " />

										<p:selectBooleanCheckbox id="redigente" />
									</p:column>
									<p:column>

										<h:outputLabel for="deliberante" value="Deliberante: " />

										<p:selectBooleanCheckbox id="deliberante" />

									</p:column>
									<p:column>

										<h:outputLabel for="organismoStatutario"
											value="Organismo Statutario: " />

									</p:column>
									<p:column>

										<p:selectOneMenu id="organismoStatutario">
											<f:selectItem itemLabel="Scegli Organismo Statutario"
												itemValue="" />
											<f:selectItems
												value="#{searchAttoController.organismiStatutari}" />
										</p:selectOneMenu>

									</p:column>
								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="numeroLCR" value="Numero LCR: " />

										<p:inputText id="numeroLCR" size="5" maxlength="5" />
									</p:column>
									<p:column>



									</p:column>
									<p:column>

										<h:outputLabel for="soggettoConsultato"
											value="Soggetto consultato: " />

									</p:column>
									<p:column>

										<p:inputText id="soggettoConsultato" />


									</p:column>
								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="numeroLR" value="Numero LR: " />

										<p:inputText id="numeroLR" size="5" maxlength="5" />
									</p:column>
									<p:column>

										<h:outputLabel for="anno" value="Anno: " />
										<p:inputText id="anno" size="4" maxlength="4" />

									</p:column>
									<p:column>



									</p:column>
									<p:column>



									</p:column>
								</p:row>

								<p:row>
									<p:column>

										<h:outputLabel for="abbonamento" value="Abbonamento: " />

										<p:selectBooleanCheckbox id="abbonamento" />
									</p:column>
									<p:column>

										<h:outputLabel for="stralcio" value="Stralcio: " />
										<p:selectBooleanCheckbox id="stralcio" />

									</p:column>
									<p:column colspan="3">

										<h:outputLabel for="emendato" value="Emendato: " />
										<p:selectBooleanCheckbox id="emendato" />
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<h:outputLabel for="rinviato" value="Rinviato: " />
										<p:selectBooleanCheckbox id="rinviato" />
									&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									<h:outputLabel for="sospeso" value="Sospeso: " />
										<p:selectBooleanCheckbox id="sospeso" />

									</p:column>

								</p:row>
								<p:row>
									<p:column>

										<p:commandButton type="button" outcome="productDetail"
											value="Ricerca semplice"
											onclick="hidePanel('ricercaAvanzataDiv', 'ricercaAvanzataButton')">

										</p:commandButton>
									</p:column>
								</p:row>

							</p:panelGrid>

						</div>

						<script type="javascript">
                    //hidePanel('ricercaAvanzataDiv', 'ricercaAvanzataButton');
                    $("#ricercaAvanzataDiv").hide();
                </script>
						<p:panelGrid>


							<p:row>

								<p:column>
									<div id="ricercaAvanzataButton">
										<p:commandButton type="button" outcome="productDetail"
											value="Ricerca avanzata"
											onclick="showPanel('ricercaAvanzataDiv', 'ricercaAvanzataButton')" />
									</div>


								</p:column>
							</p:row>
							<p:row>
								<p:column colspan="3">

									<p:commandButton value="Cerca" update="listaAtti"
										id="btncercaatto_cerca"
										actionListener="#{searchAttoController.searchAtti()}" />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<h:commandLink value="Esporta Excel" id="btncercaatto_exl">
										<p:dataExporter type="xls" target="listaAtti"
											fileName="lista_atti" />
									</h:commandLink>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<p:commandButton value="Reimposta" update="searchPanel"
										id="btncercaatto_reset" />
								</p:column>


							</p:row>


						</p:panelGrid>
					</p:column>
				</p:row>
			</p:panelGrid>

			<!-- Pannello ricerca end -->
			<p:panelGrid id="listaLavoroPanel"
				style="width:100%;margin-bottom:7px;border:1px solid #4F4F4F">

				<p:row>
					<p:column>
						<h:outputLabel for="listaLavoro" value="Lista di Lavoro : "
							style="valign:middle" />
						<p:selectOneMenu id="listaLavoro"
							value="#{searchAttoController.listaLavoro}">
							<f:selectItem itemLabel="Tutti gli Atti" itemValue="tutti" />
							<f:selectItem itemLabel="In lavorazione"
								itemValue="inlavorazione" />
							<f:selectItem itemLabel="Lavorati" itemValue="lavorati" />
						</p:selectOneMenu>

					</p:column>
				</p:row>

			</p:panelGrid>

			<h3>Risultati ricerca</h3>

			<p:dataTable id="listaAtti" var="atto"
				value="#{searchAttoController.listAtti}" rows="5" paginator="true"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {NextPageLink}"
				paginatorAlwaysVisible="false" paginatorPosition="bottom">
				<p:column sortBy="#{atto.tipo}">
					<f:facet name="header">Tipo</f:facet>
					<h:outputText value="#{atto.tipo}" />
				</p:column>

				<p:column sortBy="#{atto.numeroAtto}" headerText="N.Atto">
					<h:outputText value="#{atto.numeroAtto}" />
				</p:column>
				<p:column sortBy="#{atto.numeroProtocollo}" headerText="NÂ° Protocollo">
					<h:outputText value="#{atto.numeroProtocollo}" />
				</p:column>
				<p:column sortBy="#{atto.oggetto}" headerText="Oggetto">
					<h:outputText value="#{atto.oggetto}" />
				</p:column>
				<p:column headerText="Azioni">
					
					<p:commandButton action="#{gestioneSeduteController.addAttoTrattato}"
						value="Aggiungi a Trattati"
						immediate="true"
						update=":gestioneSeduteForm:gestioneSedute"
						icon="new-icon">
						<f:setPropertyActionListener value="#{atto.id}"
							target="#{gestioneSeduteController.attoDaTrattare}" />
					</p:commandButton>	
					&nbsp; &nbsp; &nbsp;
				</p:column>
			</p:dataTable>

			<br />

			<p:panelGrid styleClass="infoTable">
				<p:row>
					<p:column>

						<b><h:outputLabel for="selezioneSeduta"
								value="Selezione seduta:  " />
						</b>
						
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					
						<p:selectOneMenu id="selezioneSeduta"
							value="#{gestioneSeduteController.dataSedutaSelected}">
							<f:selectItems value="#{gestioneSeduteController.dateSeduteList}"
							/>
							<p:ajax event="change"
								listener="#{gestioneSeduteController.showSedutaDetail}"
								update="inserisciODGGrid" />
						</p:selectOneMenu>
					</p:column>
					<p:column>
						<h:commandLink value="Stampa ODG" id="stampaODG">

						</h:commandLink>
					</p:column>
				</p:row>
				<p:row>
					<p:column colspan="2">

						<table class="generalInfoTab" id="ordineDelGiorno"
							style="width: 100%;" border="0">
							<thead>
								<th>Ordine del Giorno per la seduta del <h:outputText
										value="#{gestioneSeduteController.dataSedutaSelected}">
										<f:convertDateTime locale="it_IT" pattern="dd/MM/yyyy" />
									</h:outputText></th>

							</thead>
						</table>


					</p:column>
				</p:row>
			</p:panelGrid>
			<p:fieldset styleClass="fieldSetTab" legend="Atti trattati "
				collapsed="false" toggleable="false">
				<!-- <p:orderList value="#{gestioneSeduteController.attiTrattati}" var="attoTrattato" iconOnly="false" effect="clip"  
                     controlsLocation="left" id="listaAttiTrattati" itemValue="#{attoTrattato}" style="width: 100%;" >   -->
				<p:dataTable id="listaAttiTrattati"
					value="#{gestioneSeduteController.attiTrattati}" var="attoTrattato"
					styleClass="generalInfoTab grey-text" editable="true">

					<p:column sortBy="#{attoTrattato.atto.tipoAtto}" headerText="Tipo Atto" style="width:125px">
							#{attoTrattato.atto.tipoAtto}
    			</p:column>

					<p:column sortBy="#{attoTrattato.atto.numeroAtto}" headerText="N.Atto" style="width:125px">
					#{attoTrattato.atto.numeroAtto}
				</p:column>

					<p:column sortBy="#{attoTrattato.atto.oggetto}" headerText="Oggetto" style="width:125px">
					#{attoTrattato.atto.oggetto}
				</p:column>

					<p:column sortBy="#{attoTrattato.previsto}" headerText="Previsto" style="width:125px">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="si" rendered="#{attoTrattato.previsto}" />
								<h:outputText value="no" rendered="#{!attoTrattato.previsto}" />
							</f:facet>
							<f:facet name="input">
								<p:selectBooleanCheckbox value="#{attoTrattato.previsto}">
									<p:ajax event="change"
										listener="#{gestioneSeduteController.updateInserisciOdgHandler}" />
								</p:selectBooleanCheckbox>
							</f:facet>
						</p:cellEditor>
					</p:column>

					<p:column sortBy="#{attoTrattato.discusso}" headerText="Discusso" style="width:125px">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="si" rendered="#{attoTrattato.discusso}" />
								<h:outputText value="no" rendered="#{!attoTrattato.discusso}" />
							</f:facet>
							<f:facet name="input">
								<p:selectBooleanCheckbox value="#{attoTrattato.discusso}">
									<p:ajax event="change"
										listener="#{gestioneSeduteController.updateInserisciOdgHandler}" />
								</p:selectBooleanCheckbox>
							</f:facet>
						</p:cellEditor>
					</p:column>

					
					<p:column headerText="Modifica" style="width:50px">
						<p:rowEditor />
					</p:column>

				</p:dataTable>

			</p:fieldset>
		</p:column>
	</p:row>
	<p:row>
		<p:column>

			<c:if test="#{!navigationBean.gestioneSeduteConsultazioniAula()}">
				<ui:include src="./inserisciodgcommissionetab.xhtml" />
			</c:if>

		</p:column>
	</p:row>

	<p:row>
		<p:column>

			<c:if test="#{navigationBean.gestioneSeduteConsultazioniAula()}">
				<ui:include src="./inserisciodgaulatab.xhtml" />
			</c:if>

		</p:column>
	</p:row>

	<p:row>
		<p:column>
			<p:commandButton value="Salva"
				action="#{gestioneSeduteController.salvaInserisciOdg}"
				update="inserisciOdgMsg" />
		</p:column>
	</p:row>
</p:panelGrid>



</html>