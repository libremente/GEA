<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

<p:panelGrid styleClass="infoTable" id="emendamentiPanel">
	<p:row>
		<p:column>
			<p:fieldset styleClass="fieldSetTab" legend="Emendamenti:"
				collapsed="false" toggleable="true" toggleSpeed="500">
				<p:panelGrid styleClass="infoTable" id="emendamentiGrid">
					<p:row>
						<p:column>
							<!-- Messaggio azioni -->
							<p:growl id="emendamentoMsg" showDetail="true" sticky="false" />



							<!-- Confirm dialog -->
							<p:confirmDialog id="confirmEmendamentoDialog"
								message="Sei sicuro di voler eliminare il File ?"
								header="Cancellazione Emendamento" severity="alert"
								widgetVar="emendamentoDialog">

								<p:commandButton id="confirmEmendamento" value="Conferma"
									oncomplete="emendamentoDialog.hide()"
									action="#{esameAulaController.removeEmendamento}"
									update="listaEmendamenti" />
								<p:commandButton id="declineEmendamento" value="Annulla"
									onclick="emendamentoDialog.hide()" type="button" />

							</p:confirmDialog>
						</p:column>
					</p:row>


					<p:row>
						<!-- <p:column>
					<h:graphicImage alt="add" value="/resources/img/add.png" />
				</p:column>-->
						<p:column colspan="3">
							<p:fileUpload label="Carica Emendamento"
								fileUploadListener="#{esameAulaController.uploadEmendamento}"
								mode="advanced" auto="true"
								update="listaEmendamenti ,emendamentoMsg" />
						</p:column>
					</p:row>
					<p:row>
						<p:column colspan="4">
							<h:dataTable id="listaEmendamenti"
								value="#{esameAulaController.emendamentiList}" var="emendamento"
								styleClass="generalInfoTab grey-text">

								<h:column>
									<f:facet name="header">Emendamento</f:facet>
							#{emendamento.nome}
						</h:column>

								<h:column>
									<f:facet name="header">Azioni</f:facet>
									<h:outputText
										value="#{fn:substring(emendamento.nome, fn:indexOf(emendamento.nome,'.')+1 ,fn:length(emendamento.nome) )}" />

								</h:column>

								<h:column>
									<f:facet name="header">Pubblico</f:facet>
									<h:outputText value="si" rendered="#{emendamento.pubblico}" />
									<h:outputText value="no" rendered="#{!emendamento.pubblico}" />
								</h:column>

								<h:column>
									<f:facet name="header">Elimina</f:facet>
									<p:commandButton oncomplete="emendamentoDialog.show()"
										icon="delete-icon">

										<f:setPropertyActionListener value="#{emendamento.id}"
											target="#{esameAulaController.emendamentoToDelete}" />
									</p:commandButton>
								</h:column>


							</h:dataTable>
						</p:column>
					</p:row>

					<p:row>
						<p:column>

							<table class="generalInfoTab" id="numEmendamenti"
								style="width: 100%;" border="0">

								<tbody>
									<tr>
										<td align="left"></td>
										<td align="left">Maggior.</td>
										<td align="left">Minor.</td>
										<td align="left">Giunta</td>
										<td align="left">Misto</td>
										<td align="left"><b>Totale</b></td>
									</tr>

									<tr>
										<td align="left">Num. Emend. Presentati</td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendPresentatiMaggior}">
												<p:ajax event="change" update="totEmendPresentati"
													listener="#{esameAulaController.totaleEmendPresentati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendPresentatiMinor}">
												<p:ajax event="change" update="totEmendPresentati"
													listener="#{esameAulaController.totaleEmendPresentati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendPresentatiGiunta}">
												<p:ajax event="change" update="totEmendPresentati"
													listener="#{esameAulaController.totaleEmendPresentati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendPresentatiMisto}">
												<p:ajax event="change" update="totEmendPresentati"
													listener="#{esameAulaController.totaleEmendPresentati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText id="totEmendPresentati"
												value="#{esameAulaController.numEmendPresentatiTotale}"
												readonly="true" size="5" maxlength="5" /></td>
									</tr>

									<tr>
										<td align="left">Num. Emend. Approvati</td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendApprovatiMaggior}">
												<p:ajax event="change" update="totEmendApprovati"
													listener="#{esameAulaController.totaleEmendApprovati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendApprovatiMinor}">
												<p:ajax event="change" update="totEmendApprovati"
													listener="#{esameAulaController.totaleEmendApprovati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendApprovatiGiunta}">
												<p:ajax event="change" update="totEmendApprovati"
													listener="#{esameAulaController.totaleEmendApprovati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText size="5" maxlength="5"
												value="#{esameAulaController.numEmendApprovatiMisto}">
												<p:ajax event="change" update="totEmendApprovati"
													listener="#{esameAulaController.totaleEmendApprovati}" />
												<p:ajax event="change"
													listener="#{esameAulaController.updateEmendamentiHandler}" />
											</p:inputText></td>

										<td align="left"><p:inputText id="totEmendApprovati"
												value="#{esameAulaController.numEmendApprovatiTotale}"
												readonly="true" size="5" maxlength="5" /></td>
									</tr>

								</tbody>
							</table>

						</p:column>
					</p:row>
				</p:panelGrid>
				<p:panelGrid styleClass="infoTable" id="nonApprovati">
					<p:row>

						<p:column>Non ammissibili</p:column>
						<p:column>Decaduti</p:column>
						<p:column>Ritirati</p:column>
						<p:column>Respinti</p:column>
						<p:column>
							<b>Totale non approvati</b>
						</p:column>
					</p:row>
					<p:row>
						<p:column>
							<p:inputText size="5" maxlength="5"
								value="#{esameAulaController.nonAmmissibili}">
								<p:ajax event="change" update="totNonApprovati"
									listener="#{esameAulaController.totaleNonApprovati}" />
								<p:ajax event="change"
									listener="#{esameAulaController.updateEmendamentiHandler}" />
							</p:inputText>
						</p:column>

						<p:column>
							<p:inputText size="5" maxlength="5"
								value="#{esameAulaController.decaduti}">
								<p:ajax event="change" update="totNonApprovati"
									listener="#{esameAulaController.totaleNonApprovati}" />
								<p:ajax event="change"
									listener="#{esameAulaController.updateEmendamentiHandler}" />
							</p:inputText>
						</p:column>

						<p:column>
							<p:inputText size="5" maxlength="5"
								value="#{esameAulaController.ritirati}">
								<p:ajax event="change" update="totNonApprovati"
									listener="#{esameAulaController.totaleNonApprovati}" />
								<p:ajax event="change"
									listener="#{esameAulaController.updateEmendamentiHandler}" />
							</p:inputText>
						</p:column>

						<p:column>
							<p:inputText size="5" maxlength="5"
								value="#{esameAulaController.respinti}">
								<p:ajax event="change" update="totNonApprovati"
									listener="#{esameAulaController.totaleNonApprovati}" />
								<p:ajax event="change"
									listener="#{esameAulaController.updateEmendamentiHandler}" />
							</p:inputText>
						</p:column>

						<p:column>
							<p:inputText id="totNonApprovati"
								value="#{esameAulaController.totaleNonApprovati}"
								readonly="true" size="5" maxlength="5" />
						</p:column>
					</p:row>

					<p:row>
						<p:column>
								Note emendamenti: 
								</p:column>

						<p:column colspan="4">
							<p:inputTextarea rows="5" cols="101"
								value="#{esameAulaController.noteEmendamenti}">
								<p:ajax event="change"
									listener="#{esameAulaController.updateEmendamentiHandler}" />
							</p:inputTextarea>
						</p:column>
					</p:row>
				</p:panelGrid>
			</p:fieldset>
		</p:column>
	</p:row>

	<p:row>
		<p:column>
			<p>
				<p:commandButton value="Salva"
					action="#{esameAulaController.salvaEmendamenti}"
					update="emendamentoMsg" />
			</p>
		</p:column>

	</p:row>
</p:panelGrid>
</html>